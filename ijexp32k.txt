

         i.j Shell Property Sheets Export/Import 32 ver.1.01k7
               Copyright (C) 1999 i.j, 2004-2008 K.Takata

１．概要
    　i.j 氏の i.j Shell Property Sheets Export/Import 32 (ijexp32) (*1)
    の改造版です。
    　エクスプローラのプロパティにて、実行ファイルの PE 構造、インポート
    とエクスポートを表示します。
    　オリジナル版の機能に加え、Delphi などでコンパイルされたプログラム
    のインポート情報の表示や、64bit 実行ファイル (x64, IA64) の情報表示
    に対応しています。

      (*1) http://www.vector.co.jp/soft/win95/util/se111901.html


２．動作環境
    　Windows 98/2000/XP/Vista など
    　要 MFC42.DLL, MSVCRT.DLL, MSVCP60.DLL


３．インストール
    　本パッケージは配布ファイルサイズ削減のため、7-Zip 形式で圧縮してい
    ます。そのため、アーカイブの解凍には、7-Zip (*2) あるいは
    7-zip32.dll (*3) を使用したアーカイブソフトなどが必要になります。

      (*2) http://www.7-zip.org/
      (*3) http://www.csdinc.co.jp/archiver/lib/7-zip32.html


    　アーカイブを解凍後、エクスプローラ上で ijexp32.inf を右クリックし、
    インストールを選択してください。


４．アンインストール
    　オリジナル版の ijexp32.txt を参照してください。


５．使用法
    　オリジナル版の ijexp32.txt を参照してください。


６．エクスポート名リスト
    　オリジナル版と同様に、デバッグ版 mfc??d.dll のリストは添付していま
    せん。必要な方は各自で作成して下さい。必要なファイルは以下の場所にあ
    ります。

      VS 6.0:
         <VS のディレクトリ>\VC98\mfc\src\intel\mfc*.def

      VS.NET 2002/2003:
         <VS.NET のディレクトリ>\Vc7\atlmfc\src\intel\mfc*.def

      VS 2005/2008:
         <VS のディレクトリ>\Vc\atlmfc\src\intel\mfc*.def


    　Perl を使う場合は、例えば以下のようにすると良いでしょう。

      > perl -ne "if(/\s+;?([^\s]+)\s+\@\s*(\d+)/){printf \"%04x, %s\n\", $2, $1;}" < mfc42d.def > mfc42d.exp


７．ソースファイル
    　本ソフトのソースは、同梱の src.7z に含まれています。
    　ijexp32.dsw, ijexp32.dsp は VC6 のプロジェクトファイルです。オリジ
    ナル版とは異なり、VC5 ではコンパイルできなくなっています。
    　ijexp32.sln, ijexp32.vcproj は、VS.NET 2003 のプロジェクトファイル
    です。
    　Makefile, sources は Windows Driver Kit (WDK) 用のメイクファイルで
    す。Build Environment を起動し、build コマンドを実行すると、DLL がビ
    ルドされます。x64 実行形式のビルド用に入れてありますが、動作は未確認
    です。

    　なお、現バージョンには以下の既知のバグがあります。
        ・解析できないエクスポート名形式がある。(analyzer.cpp)

    例:
      エクスポート名:
        ?_R2@?BN@???$_Fabs@N@std@@YANABV?$complex@N@1@PAH@Z@4NB

      undname による解析結果:
        "double const `double __cdecl std::_Fabs<double>(class std::complex<double> const &,int *)'::`29'::_R2"


８．更新履歴
    2004/12/19  ver.1.01k1
        ・K.Takata による最初の公開バージョン。
        ・コンパイラを VC6 SP6 に変更。
        ・Delphi 製プログラムのインポート情報を表示できるように変更。
        ・mfc42.exp を最新の mfc42.dll に対応させたものに変更。
        ・mfc70.exp, mfc71.exp を追加。

    2005/05/09  ver.1.01k2
        ・ws2_32.exp を追加。（WinSock2 用）
        ・kernel32.exp を追加。（Win9x の非公開 API）
        ・oleaut32.exp を更新。
        ・一部の実行ファイルで落ちるのを修正。

    2005/06/20  ver.1.01k3 (非公開)
        ・sys ファイルでも、ヘッダ情報とインポート情報を表示するように変
          更。

    2008/10/25  ver.1.01k4
        ・x64(AMD64), IA64 実行ファイルの情報表示に対応。
        ・エクスポート名の解析で、VC++ 7.0 以降の wchar_t に対応。
        ・エクスポート名の解析で、シンボルの間接参照部分を一部修正。
        ・エクスポート名の解析で、数値指定のテンプレートに対応。
        ・Unicode 版の実行ファイルを追加。（ANSI 版と Unicode 版は、イン
          ストール時に OS に応じて自動選択される。）
        ・情報をファイルに保存する際、カレントディレクトリを移動しないよ
          うに変更。（移動すると一部のファイラで不都合だったため。）
        ・情報をファイルに保存する際、上書き確認を行うように変更。
        ・vcbungle.txt を更新。(wchar_t, __ptr64, __pascal など)
        ・x64 ビルドできるようにソースを修正。（動作は未確認）
        ・mfc80.exp を追加。
        ・mfc??u.exp を追加。（Unicode 版 MFC DLL 用リスト）
        ・必要ファイルを一式まとめて配布するように変更。（配布ファイルの
          サイズが大きくなってしまったため、アーカイブ形式を .7z に変更）

    2008/10/26  ver.1.01k5
        ・エクスポート名の解析を改良。（特殊メンバー名の追加、引数の間接
          参照の修正。）
        ・vcbungle.txt を更新。
        ・WinXP 以降ではファイルプロパティ画面が大きくなったのに合わせて、
          表示領域を拡大。

    2008/11/03  ver.1.01k6
        ・エクスポート名の解析を改良。
            - 関数へのポインタを返す関数の修正
            - 引数のない関数の修正
            - 引数の間接参照の修正
                - __int64 なども間接参照の対象
                - 関数の戻り値は間接参照の対象外
            - シンボルの間接参照の修正（テンプレート関係）
        ・vcbungle.txt を更新。

    2008/11/05  ver.1.01k7
        ・エクスポート名の解析を改良。
            - 引数の間接参照の修正
            - テンプレート引数の負数指定に対応
        ・LARGE_ADDRESS_AWARE フラグの表示に対応。
        ・Windows CE 実行形式の表示に一部対応。
        ・一部のボタン類にアクセスキーを設定。
        ・Copy ボタンを新設。（情報をクリップボードにコピー）


９．注意事項、その他
    ・この改造版に固有のことをオリジナル版の作者に質問することは決してし
      ないでください。
    ・ライセンスはオリジナル版に従うものとします。

        改造版作者 : K.Takata（高田 謙）
        URL        : http://webs.to/ken/
                   : http://homepage3.nifty.com/k-takata/
